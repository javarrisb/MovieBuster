"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createServices = exports.createService = void 0;
const apollo_server_express_1 = require("apollo-server-express");
const graphql_1 = require("graphql");
const gqlx_js_1 = require("gqlx-js");
const constants_1 = require("./constants");
function createService(name, gqlxSource, data, api = constants_1.defaultApi, options) {
    const gql = (0, gqlx_js_1.compile)(name, gqlxSource, api, options);
    const service = {
        name,
        createService: gql.createService,
        schema: (0, apollo_server_express_1.makeExecutableSchema)({
            typeDefs: gql.schema,
            resolvers: gql.resolvers,
        }),
        data,
    };
    (0, graphql_1.assertValidSchema)(service.schema);
    return service;
}
exports.createService = createService;
function createServices(definitions, api = constants_1.defaultApi, options) {
    return definitions.map(({ name, source, data }) => createService(name, source, data, api, options));
}
exports.createServices = createServices;
//# sourceMappingURL=service.js.map