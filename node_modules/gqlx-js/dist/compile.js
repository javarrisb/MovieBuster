"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.compile = void 0;
const utils_1 = require("./utils");
const api_1 = require("./api");
const GqlxError_1 = require("./GqlxError");
function compile(name, source, api = api_1.defaultApi, options) {
    if (!name) {
        throw new Error('No module name supplied. An unique namespace is required.');
    }
    else if (!source) {
        throw new GqlxError_1.GqlxError('Empty source supplied. An empty schema is invalid.');
    }
    else {
        const gql = (0, utils_1.parseDynamicSchema)(source);
        (0, utils_1.validate)(gql, api, options);
        const connectors = (0, utils_1.transform)(gql, api, options);
        const result = (0, utils_1.generate)(name, connectors);
        return {
            name,
            source,
            schema: gql.schema.text,
            resolvers: result.resolvers,
            createService: result.createService,
        };
    }
}
exports.compile = compile;
//# sourceMappingURL=compile.js.map